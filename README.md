# æ™ºæ…§ç°½å–®åŠæ´¾å·¥ç³»çµ± (Electronic-Approval-System)



âœ… **Firebase ç’°å¢ƒå·²å°±ç·’** - Auth, Firestore, Storage, Emulator å·²è¨­å®šå®Œæˆ  
âœ… **è³‡æ–™æµç¨‹å·²é©—è­‰** - deliveryNotes èƒ½æˆåŠŸå¯«å…¥ Firestore  
ğŸš§ **é–‹ç™¼é€²è¡Œä¸­** - 4 å€‹æ ¸å¿ƒåŠŸèƒ½æ­£åœ¨å¯¦ä½œ  
## âœ¨ ä¸»è¦ç‰¹è‰²
- **å·¥æ™‚è¨ˆç®—**ï¼šè¨˜éŒ„é–‹å§‹/çµæŸæ™‚é–“ï¼Œè‡ªå‹•è¨ˆç®—ç¸½å·¥æ™‚ï¼ˆæ”¯æ´è·¨æ—¥èˆ‡å°æ•¸è¡¨ç¤ºï¼‰ã€‚
- **è¨˜éŒ„å®Œæ•´æ€§**ï¼šç°½å–®åŒ…å«æ—¥æœŸã€å®¢æˆ¶ã€æ–½å·¥åœ°é»ã€ä½œæ¥­ç‹€æ³ã€è»Šè™Ÿã€å¸æ©Ÿã€é‡‘é¡ã€å‚™è¨»ã€å®¢æˆ¶ç°½ç« ç­‰æ¬„ä½ã€‚
- **é›¢ç·šæ”¯æ´**ï¼šè¡Œå‹•è£ç½®å¯é›¢ç·šå¡«å¯«ç°½å–®ï¼Œç¶²è·¯æ¢å¾©å¾Œè‡ªå‹•åŒæ­¥ã€‚
- Emulator UI èƒ½çœ‹åˆ° Firestore/Auth/Storage æœå‹™  
- å¡«å¯«è¡¨å–®é€å‡ºå¾Œï¼Œ`deliveryNotes` collection å‡ºç¾æ–°è³‡æ–™  
- èƒ½æ­£å¸¸åœ¨ä¸åŒé é¢é–“å°èˆª  

---


| Issue | åŠŸèƒ½                 | è² è²¬äºº | ç‹€æ…‹       | æª”æ¡ˆ                          |
|-------|----------------------|--------|------------|-------------------------------|
| #1    | å·¥æ™‚è¨ˆç®— & è¡¨å–®é©—è­‰  | å¾…åˆ†é… | ğŸ”„ é€²è¡Œä¸­  | `js/form-validation.js`       |
| #2    | ç°½å Canvas & Storage | å¾…åˆ†é… | ğŸ”„ é€²è¡Œä¸­  | `js/signature.js`             |
| #3    | Firebase Auth æ•´åˆ   | å¾…åˆ†é… | ğŸ”„ é€²è¡Œä¸­  | `js/auth.js`                  |
| #4    | History & é›¢ç·šåŒæ­¥   | å¾…åˆ†é… | ğŸ”„ é€²è¡Œä¸­  | `js/history.js, js/offline.js`|

---

## ğŸ§ª æ¸¬è©¦æµç¨‹
### åŸºç¤æ¸¬è©¦
1. é–‹å•Ÿ `http://localhost:3000/new-delivery.html`  
2. å¡«å¯«è¡¨å–®å„æ¬„ä½  
3. é»æ“Šã€Œå®Œæˆç°½å–®ã€  
4. æª¢æŸ¥ Emulator UI (`http://127.0.0.1:4450`) â†’ Firestore â†’ `deliveryNotes`  
5. ç¢ºèªæ–°è³‡æ–™å‡ºç¾ä¸”æ ¼å¼æ­£ç¢º  

### æ•´åˆæ¸¬è©¦
- **ç™»å…¥æ¸¬è©¦**ï¼šä½¿ç”¨ `dev@example.com / test123`  
- **å·¥æ™‚æ¸¬è©¦**ï¼šæ¸¬è©¦åŒæ—¥èˆ‡è·¨æ—¥æ™‚é–“è¨ˆç®—  
- **ç°½åæ¸¬è©¦**ï¼šCanvas ç°½åä¸¦ç¢ºèªä¸Šå‚³åˆ° Storage  
- **é›¢ç·šæ¸¬è©¦**ï¼šé—œé–‰ç¶²è·¯å¡«è¡¨ â†’ é–‹å•Ÿç¶²è·¯ â†’ ç¢ºèªåŒæ­¥  


### å‰ç½®æ¢ä»¶
- **Node.js 18+** â†’ [ä¸‹è¼‰](https://nodejs.org/)  
- **Firebase CLI** â†’ `npm i -g firebase-tools`  

### å¿«é€Ÿå•Ÿå‹•ï¼ˆPowerShellï¼‰
```powershell
# 1. Clone å°ˆæ¡ˆ
git clone https://github.com/Kiwi485/Electronic-Approval-System.git
cd Electronic-Approval-System

# 2. å•Ÿå‹• Firebase Emulator  
firebase emulators:start
# ğŸ”— Emulator UI: http://127.0.0.1:4450

# 3. å•Ÿå‹•å‰ç«¯ï¼ˆå¦é–‹ PowerShell è¦–çª—ï¼‰
# æ¨è–¦ï¼šå¸¶æ——æ¨™ä»¥å•Ÿç”¨ CORS/GZIP/Brotli èˆ‡é è¨­å‰¯æª”å
npx http-server .\prototype -p 3000 -a 0.0.0.0 -c-1 --cors --gzip --brotli -e html
# æˆ–ä½¿ç”¨è…³æœ¬ï¼šscripts\start_http_3000.bat
# ğŸ”— å‰ç«¯: http://localhost:3000/new-delivery.html?emu=1


äº†è§£ ğŸ‘ ä½ è¦çš„æ˜¯æŠŠ **æ‰€æœ‰ FAQ çš„å•é¡Œèˆ‡ç­”æ¡ˆ** å®Œæ•´æ”¶éŒ„æˆ **Markdown Q\&A æ–‡ä»¶**ã€‚ä»¥ä¸‹æ˜¯æ•´ç†å¥½çš„ç‰ˆæœ¬ï¼š

````markdown
## â“ å¸¸è¦‹å•é¡Œ (FAQ)

### 1. ç‚ºä»€éº¼ `firebase` æŒ‡ä»¤æ‰¾ä¸åˆ°ï¼Ÿ
- **å•é¡Œ**ï¼šPowerShell é¡¯ç¤ºã€Œfirebase ä¸æ˜¯å…§éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ã€  
- **è§£æ±ºæ–¹æ¡ˆ**ï¼šç¢ºèªå·²å®‰è£ Firebase CLI â†’  
  ```powershell
  npm i -g firebase-tools
````

ä¸¦é‡æ–°å•Ÿå‹•çµ‚ç«¯æ©Ÿ

---

### 2. Emulator èªª port è¢«ä½”ç”¨ï¼Ÿ

* **å•é¡Œ**ï¼š`firebase emulators:start` é¡¯ç¤º port 4000/8080 è¢«ä½”ç”¨
* **è§£æ±ºæ–¹æ¡ˆ**ï¼šé—œé–‰å·²ä½”ç”¨çš„ç¨‹å¼ï¼Œæˆ–åœ¨ `firebase.json` ä¸­ä¿®æ”¹ port

---

### 3. è¡¨å–®é€å‡ºå¾Œæ²’æœ‰è³‡æ–™ï¼Ÿ

* **å•é¡Œ**ï¼šé»æ“Šé€å‡ºå¾Œ Firestore æ²’æœ‰æ–°è³‡æ–™
* **æª¢æŸ¥æ¸…å–®**ï¼š

  * Emulator æœ‰å•Ÿå‹•ä¸” UI å¯è¨ªå• ([http://localhost:4000](http://localhost:4000))
  * Browser Console æœ‰å°å‡ºã€ŒğŸ“Œ å³å°‡é€å‡ºçš„è³‡æ–™ã€
  * æ²’æœ‰ JavaScript éŒ¯èª¤
  * è¡¨å–®æ‰€æœ‰å¿…å¡«æ¬„ä½éƒ½æœ‰å¡«å¯«

---

### 4. PowerShell åŸ·è¡Œæ”¿ç­–å•é¡Œ

* **å•é¡Œ**ï¼šã€Œå› ç‚ºé€™å€‹ç³»çµ±ä¸Šå·²åœç”¨æŒ‡ä»¤ç¢¼åŸ·è¡Œã€
* **è§£æ±ºæ–¹æ¡ˆ**ï¼šåŸ·è¡Œ

  ```powershell
  Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
  ```

---

### 5. åœ˜éšŠæˆå“¡éœ€è¦å®‰è£ä»€éº¼ï¼Ÿ

* **å•é¡Œ**ï¼šæ–°æˆå“¡åŠ å…¥æ™‚ï¼Œéœ€è¦å®‰è£å“ªäº›ç’°å¢ƒï¼Ÿ
* **è§£æ±ºæ–¹æ¡ˆ**ï¼š

  * **æœ€å°éœ€æ±‚**ï¼š

    * Node.jsï¼ˆè‡ªè¡Œå®‰è£ï¼‰
    * Firebase CLIï¼ˆè‡ªè¡Œå®‰è£ï¼‰
    * http-serverï¼ˆè‡ªè¡Œå®‰è£ï¼‰
  * **å…¶ä»–æª”æ¡ˆ**ï¼šé€é `git pull` å–å¾—å³å¯

```

é€™æ¨£æ‰€æœ‰ FAQ çš„ **å•é¡Œ + ç­”æ¡ˆ** éƒ½å®Œæ•´æ”¶éŒ„äº† âœ…  
è¦ä¸è¦æˆ‘å¹«ä½ æŠŠé€™ä»½ FAQ **å–®ç¨å­˜æˆ `FAQ.md` æª”æ¡ˆ**ï¼Œæ–¹ä¾¿åœ˜éšŠæˆå“¡å¿«é€ŸæŸ¥çœ‹ï¼Ÿ
```

å¾ˆå¥½ ğŸ‘Œ ä½ æƒ³è¦çµ¦éšŠå‹ä¸€å€‹æ¸…æ¥šçš„äº¤ä»£ï¼Œå‘Šè¨´ä»–å€‘ **ç¾åœ¨ç™¼ç”Ÿäº†ä»€éº¼**ã€**ç‚ºä»€éº¼æœƒçœ‹åˆ° branchLiu**ï¼Œä»¥åŠ **ä»–å€‘æ¥ä¸‹ä¾†è¦æ€éº¼åš**ã€‚æˆ‘å¹«ä½ æ•´ç†æˆä¸€ä»½å¯ä»¥ç›´æ¥è²¼çµ¦éšŠå‹çš„è¨Šæ¯ï¼ˆMarkdown æ ¼å¼ï¼‰ï¼Œæ–¹ä¾¿ä½ æ”¾åœ¨ README æˆ–ç¾¤çµ„ã€‚

---
## ğŸ“ åœ˜éšŠåˆ†æ”¯èªªæ˜

### ğŸ“Œ ç™¼ç”Ÿäº†ä»€éº¼

* æˆ‘å·²ç¶“æŠŠ **branchLiu** çš„ PR merge åˆ° `main`ã€‚
* é€™ä»£è¡¨ **branchLiu çš„ç¨‹å¼ç¢¼å·²ç¶“åœ¨ main è£¡**ï¼ŒåŠŸèƒ½ä¸æœƒæ¶ˆå¤±ã€‚
* PR merge å¾Œï¼Œ`branchLiu` åˆ†æ”¯å·²ç¶“æ²’æœ‰å­˜åœ¨çš„å¿…è¦ã€‚
* ä¸é GitHub ä»ç„¶é¡¯ç¤º branchLiuï¼Œå› ç‚º **é ç«¯åˆ†æ”¯é‚„æ²’åˆªæ‰**ï¼Œè€Œä¸” **å¤§å®¶æœ¬åœ°é›»è…¦å¯èƒ½é‚„ç•™æœ‰ branchLiu**ã€‚

---

### âœ… æˆ‘åšäº†ä»€éº¼

* PR merge å®Œæˆã€‚
* main å·²ç¶“æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚
* æº–å‚™åˆªé™¤é ç«¯ `branchLiu` åˆ†æ”¯ï¼Œé¿å…æ··äº‚ã€‚

---

### ğŸ‘©â€ğŸ’» ä½ å€‘éœ€è¦åšä»€éº¼

1. **æ›´æ–°æœ¬åœ° main**

   ```bash
   git checkout main
   git pull origin main
   ```

2. **åˆªæ‰æœ¬åœ° branchLiuï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰**

   ```bash
   git branch -d branchLiu
   ```

   > å¦‚æœå‡ºéŒ¯ï¼Œå¯ä»¥ç”¨ `git branch -D branchLiu` å¼·åˆ¶åˆªé™¤ã€‚

3. **ä¹‹å¾Œé–‹ç™¼æ–°åŠŸèƒ½**

   * ä¸è¦å†ç”¨ `branchLiu`ã€‚
   * æ¯å€‹æ–°åŠŸèƒ½è¦å¾æœ€æ–°çš„ main é–‹ä¸€å€‹æ–°åˆ†æ”¯ï¼š

     ```bash
     git checkout main
     git pull origin main
     git checkout -b feature/your-feature-name
     ```

---

### âš ï¸ æ³¨æ„

* `main` åˆ†æ”¯æ˜¯ç©©å®šåˆ†æ”¯ï¼Œè«‹ä¸è¦ç›´æ¥åœ¨ `main` ä¸Šé–‹ç™¼ã€‚
* åŠŸèƒ½é–‹ç™¼ â†’ æ–°åˆ†æ”¯ â†’ commit â†’ push â†’ PR â†’ merge â†’ åˆªåˆ†æ”¯ã€‚

---

ğŸ‘‰ é€™æ¨£å¤§å®¶éƒ½æœƒçŸ¥é“ **ç‚ºä»€éº¼ branchLiu é‚„åœ¨**ï¼Œä»¥åŠ **æ­£ç¢ºçš„æ“ä½œæ–¹å¼**ã€‚

è¦ä¸è¦æˆ‘å¹«ä½ åšä¸€å€‹ **ã€ŒGit Flow åœ–è§£ã€**ï¼ˆæµç¨‹åœ–ï¼šmain â†’ feature branch â†’ PR â†’ merge â†’ åˆªåˆ†æ”¯ï¼‰ï¼Œçµ¦éšŠå‹æ›´ç›´è¦ºçš„è¦–è¦ºç‰ˆï¼Ÿ

éå¸¸å¥½ ğŸ‘
ä»¥ä¸‹æ˜¯ä¸­æ–‡ç‰ˆçš„ **READMEã€Œé€€å›ï¼ˆRevertï¼‰æ•™å­¸æ®µè½ã€æ¨¡æ¿**ï¼Œ
ä½ å¯ä»¥ç›´æ¥è²¼åˆ°å°ˆæ¡ˆçš„ `README.md` è£¡ï¼Œè®“éšŠå‹æ¸…æ¥šçŸ¥é“ï¼š
ğŸ’¡ **ä»€éº¼æƒ…æ³ç™¼ç”Ÿäº†ã€ç‚ºä»€éº¼è¦é€€ã€è¦æ€éº¼æ“ä½œã€‚**

---

## ğŸ§­ å°ˆæ¡ˆå›é€€ç´€éŒ„ï¼ˆRevert Historyï¼‰

### ğŸ”¹ å›é€€åˆ†æ”¯ï¼š`branchAuthentication`

**æ—¥æœŸï¼š** 2025/10/05
**å›é€€çš„ Commitï¼š** `4c161e1`
**å°æ‡‰çš„ PR ç·¨è™Ÿï¼š** #13
**åŸå› èªªæ˜ï¼š**
éšŠå‹åœ¨æœªç¶“å®Œæ•´å¯©æŸ¥çš„æƒ…æ³ä¸‹ï¼Œå°‡ `branchAuthentication`ï¼ˆåŒ…å« Firebase Email ç™»å…¥èˆ‡è‡ªå‹•å¸¶å…¥è»Šç‰ŒåŠŸèƒ½ï¼‰
ç›´æ¥åˆä½µï¼ˆmergeï¼‰é€² `main`ã€‚
ç‚ºäº†è®“å°ˆæ¡ˆå›åˆ°ç©©å®šç‰ˆæœ¬ï¼Œæˆ‘å€‘åŸ·è¡Œäº† **Revertï¼ˆæ’¤éŠ·åˆä½µï¼‰** æ“ä½œã€‚

---

## âš™ï¸ å›é€€æ“ä½œæ­¥é©Ÿï¼ˆRevert æ“ä½œæ•™å­¸ï¼‰

### ğŸ§© 1ï¸âƒ£ åˆ‡æ›åˆ° main åˆ†æ”¯ä¸¦æ›´æ–°

```bash
git checkout main
git pull origin main
```

---

### ğŸ§© 2ï¸âƒ£ åŸ·è¡Œ Revert åˆä½µ

```bash
git revert -m 1 4c161e1
```

> ğŸ’¡ `-m 1` ä»£è¡¨ä¿ç•™ main çš„å…§å®¹ï¼Œåªæ’¤éŠ·è¢«åˆä½µé€²ä¾†çš„é‚£å€‹åˆ†æ”¯ (`branchAuthentication`)ã€‚
> Git æœƒè‡ªå‹•é–‹å•Ÿç·¨è¼¯è¦–çª—ï¼Œé¡¯ç¤ºé è¨­è¨Šæ¯ï¼š
> `Revert "Merge pull request #13 from Kiwi485/branchAuthentication"`

---

### ğŸ§© 3ï¸âƒ£ å„²å­˜ä¸¦é›¢é–‹ç·¨è¼¯å™¨ï¼ˆVimï¼‰

åœ¨è¦–çª—ä¸­æŒ‰ï¼š

```
Esc
:wq
```

ç„¶å¾ŒæŒ‰ Enterã€‚

---

### ğŸ§© 4ï¸âƒ£ æ¨é€å› GitHub

```bash
git push origin main
```

---

## âœ… å›é€€å®Œæˆå¾Œçµæœ

* `main` åˆ†æ”¯çš„å…§å®¹å·²å›åˆ° **åˆä½µå‰çš„ç©©å®šç‰ˆæœ¬**ã€‚
* GitHub ä¸Šæœƒè‡ªå‹•æ–°å¢ä¸€ç­†ç´€éŒ„ï¼š

  ```
  Revert "Merge pull request #13 from Kiwi485/branchAuthentication"
  ```
* èˆŠçš„åŠŸèƒ½ï¼ˆFirebase ç™»å…¥ã€è‡ªå‹•å¸¶å…¥è»Šç‰Œï¼‰å·²è¢«å®Œæ•´ç§»é™¤ã€‚

---

## ğŸš« é é˜²æªæ–½

ç‚ºäº†é¿å…å†ç™¼ç”Ÿèª¤åˆä½µï¼Œè«‹éµå®ˆä»¥ä¸‹è¦ç¯„ï¼š

1. **ä¸å¾—ç›´æ¥ push åˆ° mainã€‚**
   æ¯æ¬¡ä¿®æ”¹éƒ½å¿…é ˆå…ˆé–‹åˆ†æ”¯ï¼ˆbranchï¼‰ä¸¦é€å‡º Pull Requestã€‚

2. **å»ºç«‹ main ä¿è­·è¦å‰‡ï¼ˆBranch Protectionï¼‰**

   * é€²å…¥ GitHub â†’ `Settings` â†’ `Branches` â†’ `Add rule`
   * è¨­å®šä¿è­· `main` åˆ†æ”¯ï¼Œä¸¦å‹¾é¸ä»¥ä¸‹é¸é …ï¼š

     * âœ… Require pull request before merging
     * âœ… Require review before merge
     * âœ… Disallow force pushesï¼ˆç¦æ­¢å¼·åˆ¶æ¨é€ï¼‰

---

## ğŸ“˜ å°æé†’

å¦‚æœä¸‹æ¬¡æœ‰äººèª¤ mergeï¼Œä¹Ÿå¯ä»¥ç…§æœ¬æ®µæ­¥é©ŸåŸ·è¡Œï¼š

```bash
git revert -m 1 <é‚£æ¬¡ merge çš„ commit ID>
git push origin main
```

---




## ğŸ†• æœ€æ–°åŠŸèƒ½æ›´æ–°ï¼ˆ2025-10ï¼‰

### 1. Email / å¯†ç¢¼ç™»å…¥èˆ‡ç‹€æ…‹ç®¡ç†
- æ–°å¢ç™»å…¥é  `login.html`ï¼šä½¿ç”¨ Firebase Authentication `Email/Password`ã€‚
- ä¿æŒç™»å…¥ï¼ˆRemember meï¼‰ï¼šå‹¾é¸ â†’ ä½¿ç”¨ `browserLocalPersistence`ï¼›æœªå‹¾é¸ â†’ `browserSessionPersistence`ã€‚
- ç™»å‡ºä½¿ç”¨ `logout()` å‘¼å« Firebase `signOut()`ï¼Œä¸å†åªæ˜¯è·³è½‰é é¢ã€‚
- æ‰€æœ‰å—ä¿è­·é é¢ï¼ˆé¦–é ã€æ­·å²ã€å»ºç«‹ç°½å–®ã€ç°½ç« ï¼‰éƒ½éœ€ç™»å…¥å¾Œæ‰å¯ç€è¦½ã€‚

#### è¨­å®šæ­¥é©Ÿ
1. Firebase Console â†’ Authentication â†’ Sign-in method â†’ å•Ÿç”¨ã€ŒEmail/Passwordã€ã€‚
2. Users â†’ Add user å»ºç«‹æ¸¬è©¦å¸³è™Ÿï¼ˆä¾‹ï¼š`dev@example.com / test123`ï¼‰ã€‚
3. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ï¼š
   ```bash
   npx http-server prototype -p 3000
   ```
4. ç€è¦½ `http://localhost:3000/login.html` ç™»å…¥å¾Œæ‰æœƒé€²å…¥é¦–é ã€‚

#### å—ä¿è­·é é¢æ©Ÿåˆ¶
- é€é `auth.js` çš„ `requireAuth()`ï¼šæœªç™»å…¥æœƒ redirect â†’ `login.html?r=<åŸé >`ã€‚
- ç‚ºé¿å…ã€Œæœªé©—è­‰å‰å…§å®¹é–ƒç¾ã€ï¼Œ`requireAuth()` æœƒæš«æ™‚éš±è—æ•´é  (`html{visibility:hidden;}`) â†’ é©—è­‰å¾Œé¡¯ç¤ºã€‚

#### å…±ç”¨å®ˆé–€ç¨‹å¼ç¢¼ï¼ˆauth-guardï¼‰
```html
<script type="module" src="js/auth-guard.js"></script>
```
æª”æ¡ˆ `js/auth-guard.js` åŠŸèƒ½ï¼š
- åŸ·è¡Œ `requireAuth()`
- é¡¯ç¤ºç›®å‰ä½¿ç”¨è€… Email
- ç¶å®šç™»å‡ºæŒ‰éˆ• `#logoutBtn`

### 2. ç°½ç« æµç¨‹å¤–ç§»ï¼ˆç°½å–®å»ºç«‹ â†’ å¾Œè£œç°½ç« ï¼‰
åŸæµç¨‹ï¼šå»ºç«‹ç°½å–®ç•¶ä¸‹ç°½å â†’ å·²ç§»é™¤  
æ–°æµç¨‹ï¼š
1. åœ¨ `new-delivery.html` å»ºç«‹ç°½å–® â†’ è‡ªå‹•å¯«å…¥ï¼š
   - `signatureStatus: 'pending'`
   - `signatureDataUrl: null`ï¼ˆæ”¹æ¡ URL æ–¹æ¡ˆå¾Œå¯ç‚º `signatureUrl`ï¼‰
2. ç°½ç« é  `sign-delivery.html`ï¼š
   - å·¦å´è‡ªå‹•è¼‰å…¥ã€Œå¾…ç°½ç« ã€æ¸…å–®ï¼ˆ`signatureStatus == 'pending'`ï¼Œå„ªå…ˆä¾ `serverCreatedAt` æ’åºï¼Œæœ‰ fallback æŸ¥è©¢ï¼‰
   - é»ä¸€ç­† â†’ å³å´é¡¯ç¤ºç°½å–®å…§å®¹ + ç°½å Canvas
   - ç°½å â†’ å„²å­˜ â†’ `signatureStatus: 'completed'` + `signedAt` + ä¸Šå‚³ç°½ç« åœ–ç‰‡
   - å¯é‡æ–°ç°½ç« ï¼ˆé‚„åŸç‚º pending ä¸¦åˆªé™¤èˆŠåœ–ï¼‰

### 3. ç°½ç« åœ–ç‰‡ä¸Šå‚³ï¼ˆFirebase Storageï¼‰
- ç°½ç« å„²å­˜æ–¼ `signatures/<docId>_<timestamp>.png`
- Firestore æ–‡ä»¶æ¬„ä½ï¼š
  - `signatureUrl`: Storage ä¸‹è¼‰ URL
  - `signatureStoragePath`: æª”æ¡ˆè·¯å¾‘ï¼ˆé‡æ–°ç°½ç« æ™‚åˆªé™¤èˆŠæª”ç”¨ï¼‰
  - `signedAt`: serverTimestamp()
  - `signatureStatus`: 'pending' | 'completed'

#### Storage è¦å‰‡ï¼ˆéœ€æ›´æ–°ï¼‰
```rules
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /signatures/{fileName} {
      allow read: if request.auth != null;
      allow write: if request.auth != null
                   && request.resource.size < 2 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }
    match /{allPaths=**} {
      allow read: if request.auth != null;
    }
  }
}
```

### 4. è¡¨å–®é©—è­‰èˆ‡è‡ªå‹•è¨ˆç®—
`form-validation.js` æ–°å¢ï¼š
- é–‹å§‹ / çµæŸæ™‚é–“é©—è­‰ + è·¨æ—¥æ”¯æ´ï¼ˆå‹¾é¸ã€Œè·¨æ—¥ã€ï¼‰
- è‡ªå‹•è¨ˆç®—ç¸½å·¥æ™‚ï¼ˆå››æ¨äº”å…¥è‡³ 0.1ï¼‰
- é‡‘é¡è¼¸å…¥å³æ™‚åƒåˆ†ä½æ ¼å¼åŒ–ï¼ˆé¡¯ç¤ºç”¨ input + éš±è— raw inputï¼‰
- å¿…å¡«æ¬„ä½ï¼šæ—¥æœŸ / å®¢æˆ¶ / åœ°é» / é–‹å§‹æ™‚é–“ / çµæŸæ™‚é–“ / é‡‘é¡
- é¸å¡«æ¬„ä½ï¼šæ©Ÿå…· / è»Šè™Ÿ / å¸æ©Ÿå§“å / å‚™è¨»
- Firestore å¯«å…¥å‰æœƒå›å‚³ä¹¾æ·¨ payloadï¼ˆæ•¸å­—é‡‘é¡ã€å·¥æ™‚æ•¸å€¼ï¼‰

### 5. æ­·å²ç´€éŒ„é ï¼ˆ`history.html` / `history.js`ï¼‰
- é¡¯ç¤ºç°½ç« ç‹€æ…‹å¾½ç« ï¼šã€Œå·²ç°½ / å¾…ç°½ã€
- Modal è©³æƒ…åŠ å…¥ç°½ç« ç‹€æ…‹è³‡è¨Š
- é›¢ç·šæš«å­˜ç­†æ•¸æç¤ºèˆ‡åŒæ­¥äº‹ä»¶ç›£è½

### 6. ä¸»è¦è³‡æ–™æ¬„ä½ï¼ˆdeliveryNotesï¼‰
| æ¬„ä½ | å‹åˆ¥ | èªªæ˜ |
|------|------|------|
| customer | string | å®¢æˆ¶åç¨± |
| date | string (YYYY-MM-DD) | ä½œæ¥­æ—¥æœŸ |
| location | string | æ–½å·¥åœ°é» |
| work | string | ä½œæ¥­ç‹€æ³æè¿° |
| startTime / endTime | string(HH:mm) | æ™‚é–“å€é–“ |
| crossDay | boolean | æ˜¯å¦è·¨æ—¥ |
| totalHours | number | ç³»çµ±è¨ˆç®—å·¥æ™‚ |
| amount | number | é‡‘é¡ï¼ˆç´”æ•¸å­—ï¼‰ |
| machine | string | æ©Ÿå…· |
| vehicleNumber | string | è»Šè™Ÿ |
| driverName | string | å¸æ©Ÿå§“å |
| remark | string | å‚™è¨» |
| signatureStatus | 'pending' | 'completed' |
| signatureUrl | string|null | ç°½ç« åœ–ä¸‹è¼‰ URL |
| signatureStoragePath | string|null | Storage è·¯å¾‘ |
| signedAt | timestamp|null | å®Œæˆç°½ç« æ™‚é–“ |
| serverCreatedAt | timestamp | ä¼ºæœå™¨å»ºç«‹æ™‚é–“ |
| offline | boolean | æ˜¯å¦é›¢ç·šæš«å­˜å¾Œè£œä¸Šå‚³ |
| localId | string | é›¢ç·šæš«å­˜ç”¨ UUID |

### 7. ä½¿ç”¨æƒ…å¢ƒæµç¨‹ï¼ˆå¸æ©Ÿè¦–è§’ï¼‰
1. ç™»å…¥ â†’ é€²å…¥é¦–é   
2. å»ºç«‹ç°½å–® â†’ ç‹€æ…‹ç‚ºã€Œå¾…ç°½ã€  
3. å®¢æˆ¶å¾Œè£œç°½ï¼šé–‹å•Ÿç°½ç« é  â†’ é»é¸è©²ç­† â†’ ç°½å â†’ å„²å­˜  
4. æ­·å²ç´€éŒ„ä¸­é¡¯ç¤ºã€Œå·²ç°½ã€å¾½ç«   

### 8. å¸¸è¦‹å•é¡Œï¼ˆFAQï¼‰
| å•é¡Œ | åŸå›  | è§£æ³• |
|------|------|------|
| æœªç™»å…¥ä»çœ‹åˆ°å…§å®¹ | é é¢æœªå¼•å…¥ `auth-guard.js` | åŠ  `<script type="module" src="js/auth-guard.js"></script>` |
| ç°½ç« åˆ—è¡¨æ°¸é è¼‰å…¥ä¸­ | æŸ¥è©¢éœ€ç´¢å¼•æˆ–ç„¡è³‡æ–™ | å»ºç«‹ `signatureStatus + serverCreatedAt` è¤‡åˆç´¢å¼•æˆ–ç¢ºèªæœ‰ `signatureStatus=pending` |
| ä¸Šå‚³ç°½ç«  Forbidden | æœªç™»å…¥ / Storage è¦å‰‡æœªæ›´æ–° | é‡æ–°ç™»å…¥ / å¥—ç”¨ä¸Šæ–¹ Storage è¦å‰‡ |
| é‡‘é¡ä¸é¡¯ç¤ºåƒåˆ†ä½ | æœªè¼‰å…¥ `form-validation.js` æˆ–ä½¿ç”¨èˆŠé  | ç¢ºèªé é¢åº•éƒ¨å·²å¼•å…¥ |
| ç°½ç« å¾Œä»é¡¯ç¤º pending | å¯«å…¥å¤±æ•—æˆ– Firestore å»¶é² | é‡æ–°æ•´ç† / æŸ¥çœ‹ console éŒ¯èª¤ |

### 9. å»ºè­°å¾ŒçºŒå¾…è¾¦ï¼ˆBacklogï¼‰
| é¡åˆ¥ | é …ç›® | å„ªå…ˆ |
|------|------|------|
| å®‰å…¨ | Firestore è¦å‰‡ä¾ä½¿ç”¨è€…è§’è‰²ç´°åŒ– | P0 |
| é«”é©— | å¾…ç°½ç« é æœå°‹ / ç¯©é¸ / åˆ†é  | P1 |
| åŠŸèƒ½ | å¿˜è¨˜å¯†ç¢¼ / è¨»å†Šæµç¨‹ | P1 |
| è³‡æ–™ | æ©Ÿå…·æ¸…å–®ç¨ç«‹é›†åˆ + ä¸‹æ‹‰ | P2 |
| ç¨‹å¼ç¢¼å“è³ª | æŠ½é›¢è¡¨å–®æ¬„ä½è¨­å®š â†’ JSON é©…å‹•è¡¨å–® | P2 |

### 10. æ¸¬è©¦æ¸…å–®
- [ ] æœªç™»å…¥ç›´æ¥è¨ªå• `/index.html` â†’ è½‰å‘ `login.html`
- [ ] æ­£ç¢ºå¸³å¯†ç™»å…¥ â†’ å°å›åŸé 
- [ ] éŒ¯èª¤å¯†ç¢¼ â†’ é¡¯ç¤ºã€Œå¯†ç¢¼éŒ¯èª¤ã€
- [ ] å»ºç«‹æ–°ç°½å–® â†’ Firestore `signatureStatus=pending`
- [ ] ç°½ç«  â†’ ç”¢ç”Ÿ `signatureUrl` ä¸¦ç‹€æ…‹è®Š completed
- [ ] é‡æ–°ç°½ç«  â†’ èˆŠåœ–åˆªé™¤ï¼ˆæª¢æŸ¥ Storage è·¯å¾‘ï¼‰
- [ ] é‡‘é¡è¼¸å…¥ï¼š`12000` â†’ é¡¯ç¤º `12,000`ï¼ŒFirestore å¯«å…¥ `12000`
- [ ] é›¢ç·šå»ºç«‹å†æ¢å¾© â†’ è‡ªå‹•åŒæ­¥ä¸¦å‡ºç¾åœ¨æ­·å²åˆ—è¡¨
- [ ] ç™»å‡º â†’ å› `login.html`ï¼Œé‡æ–°è¨ªå•å—ä¿è­·é å†è¢«æ””æˆª


  

